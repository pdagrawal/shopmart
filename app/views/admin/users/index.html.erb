<% flash.each do |key, value| %>
  <div class="alert alert-<%= key %>"><%= value %></div>
<% end %>
<div class="container">
  <h2>Users List</h2><br/>
  <table class="table table-hover" border="1">
    <thead>
      <tr>
        <th>Full Name</th>
        <th>Email</th>
        <th>Roles</th>
        <th colspan="3">Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @users.each do |user| %>
        <tr>
          <td><%= user.full_name %></td>
          <td><%= user.email %></td>
          <td><%= Role.where(user_id: user.id).all.map(&:role_name) %></td>
          <td><%= link_to 'Show', admin_user_path(user) %></td>
          <% if user.id == current_user.id %>
            <td><input type="button" value="You" disabled="true"></td>
            <td><input type="button" value="Remove" disabled= "true" ></td>
          <% else %>
            <% Role.where(user_id: user.id).all.each do |role| %>
              <% if role.role_name == "Admin" %>
                <% @admin_flage = "Y" %>
              <% else %>
                <% @admin_flage = "N" %>
              <% end %>
            <% end %>
            <% if @admin_flage == "Y" %>
              <td><%= button_to "Remove Admin Role", admin_remove_admin_role_path(user.id), :method => :post %></td>
            <% else %>
              <td><%= button_to "Add Admin Role", admin_add_admin_role_path(user.id), :method => :post %></td>
            <% end %>
            <td><%= button_to 'Remove', admin_user_path(user),
                    method: :delete,
                    data: { confirm: 'Are you sure?' } %>
            </td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table><br/>
  <%= button_to "Back", root_path, :method => :get %>
</div>